<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900"
    />
    <title>Checkout — ShopAll</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>

  <body style='font-family:"Work Sans", "Noto Sans", sans-serif'>
    <div class="relative flex min-h-screen flex-col bg-slate-50 overflow-x-hidden">
      <div class="layout-container flex h-full grow flex-col">
        <!-- Header -->
        <header class="flex items-center justify-between border-b border-solid border-b-[#e7edf4] px-8 py-4">
          <div class="flex items-center gap-8">
            <div class="flex items-center gap-4 text-[#0d141c]">
              <div class="size-4">
                <svg viewBox="0 0 48 48" class="w-8 h-8" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M44 11.2727C44 14.0109 39.8386 16.3957 33.69 17.6364C39.8386 18.877 44 21.2618 44 24C44 26.7382 39.8386 29.123 33.69 30.3636C39.8386 31.6043 44 33.9891 44 36.7273C44 40.7439 35.0457 44 24 44C12.9543 44 4 40.7439 4 36.7273C4 33.9891 8.16144 31.6043 14.31 30.3636C8.16144 29.123 4 26.7382 4 24C4 21.2618 8.16144 18.877 14.31 17.6364C8.16144 16.3957 4 14.0109 4 11.2727C4 7.25611 12.9543 4 24 4C35.0457 4 44 7.25611 44 11.2727Z" fill="currentColor"></path>
                </svg>
              </div>
              <h2 class="text-[#0d141c] text-lg font-bold">ShopAll</h2>
            </div>

            <nav class="hidden md:flex gap-6 text-sm text-[#0d141c]">
              <a href="home.html" class="hover:underline">Home</a>
              <a href="#" class="hover:underline">Categories</a>
              <a href="#" class="hover:underline">New</a>
              <a href="#" class="hover:underline">Sale</a>
            </nav>
          </div>

          <div class="flex items-center gap-4">
            <div class="flex items-center bg-[#e7edf4] rounded-lg px-3 py-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-[#49719c]" viewBox="0 0 256 256" fill="currentColor"><path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path></svg>
              <input placeholder="Search" class="bg-transparent outline-none ml-2 text-sm" />
            </div>

            <button id="cart-button" class="flex items-center gap-2 bg-[#e7edf4] px-3 py-2 rounded-lg">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 256 256" fill="currentColor"><path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,160H40V56H216V200ZM176,88a48,48,0,0,1-96,0,8,8,0,0,1,16,0,32,32,0,0,0,64,0,8,8,0,0,1,16,0Z"></path></svg>
              <span id="cart-count" class="text-sm font-bold">0</span>
            </button>
          </div>
        </header>

        <!-- Page content -->
        <main class="px-8 py-8 flex-1 max-w-4xl mx-auto w-full">
          <div class="mb-4">
            <div class="text-sm text-[#49719c]">
              <a href="home.html" class="hover:underline">Home</a> / <span class="text-gray-500">Checkout</span>
            </div>
            <h1 class="text-2xl font-bold mt-3">Checkout</h1>
            <p class="text-sm text-slate-600 mt-1">Review your order and complete the purchase.</p>
          </div>

          <!-- progress -->
          <div class="my-4">
            <div class="rounded bg-[#e6eef8] h-2">
              <div class="h-2 rounded bg-[#3591f3]" style="width:33%"></div>
            </div>
            <div class="text-sm text-[#49719c] mt-1">Step 1 of 3 — Review Order</div>
          </div>

          <!-- Order summary & totals -->
          <section class="bg-white rounded shadow-sm p-4 mb-6">
            <h2 class="text-lg font-semibold mb-3">Order Summary</h2>

            <!-- items list rendered by checkout.js -->
            <div id="order-items-list" class="space-y-3"></div>

            <!-- totals -->
            <div class="mt-4 border-t pt-4 grid gap-3">
              <div class="flex justify-between">
                <div class="text-sm text-[#49719c]">Subtotal</div>
                <div id="checkout-subtotal" class="font-semibold">$0.00</div>
              </div>
              <div class="flex justify-between">
                <div class="text-sm text-[#49719c]">Shipping</div>
                <div id="checkout-shipping" class="font-semibold">Free</div>
              </div>
              <div class="flex justify-between border-t pt-3 mt-3">
                <div class="text-sm text-[#49719c]">Total</div>
                <div id="checkout-total" class="text-xl font-bold">$0.00</div>
              </div>
            </div>
          </section>

          <!-- user / timestamp info -->
          <section class="mb-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="bg-white p-4 rounded shadow-sm">
                <h3 class="font-semibold mb-2">Order Info</h3>
                <div class="text-sm text-slate-600">
                  <div>Order Timestamp: <span id="order-timestamp">—</span></div>
                  <div>User ID: <span id="order-user-id">—</span></div>
                </div>
              </div>

              <div class="bg-white p-4 rounded shadow-sm">
                <h3 class="font-semibold mb-2">Payment</h3>
                <p class="text-sm text-slate-600">Payment will be processed after you click <strong>Continue to Payment</strong>. (This demo posts the order to the backend.)</p>
              </div>
            </div>
          </section>

          <!-- continue button -->
          <div class="flex justify-end">
            <button id="continue-to-payment-btn" class="min-w-[160px] px-4 py-2 bg-[#3591f3] text-white rounded-full font-semibold">
              Continue to Payment
            </button>
          </div>
        </main>

        <footer class="py-8 text-center text-sm text-slate-500">
          &copy; <span id="current-year"></span> ShopAll. All rights reserved.
        </footer>
      </div>
    </div>

    <!-- Checkout script (expects checkout.js to be present) -->
    <script>
      // small helpers to show timestamp/userId placeholders quickly
      document.getElementById("current-year").textContent = new Date().getFullYear();
      // populate order timestamp now (will be overwritten by checkout.js if desired)
      const now = new Date();
      const tsEl = document.getElementById("order-timestamp");
      if (tsEl) tsEl.textContent = now.toLocaleString();
      // try to show a userId from localStorage if present
      const uidEl = document.getElementById("order-user-id");
      try {
        const userJson = localStorage.getItem("user");
        if (userJson) {
          const u = JSON.parse(userJson);
          if (u && (u._id || u.id)) uidEl.textContent = u._id || u.id;
        } else if (localStorage.getItem("userId")) {
          uidEl.textContent = localStorage.getItem("userId");
        } else {
          // try decode token
          const token = localStorage.getItem("uToken") || localStorage.getItem("aToken");
          if (token) {
            try {
              const payload = JSON.parse(atob(token.split('.')[1].replace(/-/g, '+').replace(/_/g, '/')));
              uidEl.textContent = payload.sub || payload._id || payload.id || payload.userId || "—";
            } catch (e) {
              // ignore
            }
          }
        }
      } catch (e) {
        // ignore
      }
    </script>

    <script src="checkout.js"></script>
  </body>
</html>
